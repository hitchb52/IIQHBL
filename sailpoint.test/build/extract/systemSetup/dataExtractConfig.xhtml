<!-- (c) Copyright 2022 SailPoint Technologies, Inc., All Rights Reserved. -->

<!DOCTYPE html PUBLIC
    "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      xmlns:sp="http://sailpoint.com/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
>
<body>

<ui:composition template="/ngAppPage.xhtml">
  <sp:loadBundle basename="sailpoint.web.messages.iiqMessages" var="msgs"/>

  <ui:define name="title">#{msgs.ui_dataextract_config_title}</ui:define>
  <ui:define name="headerItems">

    <ui:include src="../ui/scriptData.xhtml"/>
    <script type="text/javascript">
        SailPoint.DATAEXTRACT_CONFIG_FULL_ACCESS = #{sp:hasRight(facesContext, "FullAccessDataExtractConfiguration")};
    </script>
    <ui:include src="../ui/jspmInclude.xhtml"/>
    <script type="text/javascript">
        System.import('#{base.requestContextPath}/ui/js/dataExtract/DataExtractAppModule.js');
    </script>
  </ui:define>

  <ui:define name="body">
    <div class="sp-ui-app" ng-cloak="">
      <div id="notificationDiv" class="sr-only" role="alert" aria-live="assertive"></div>
      <sp-notification sp-triggerable="true"></sp-notification>
      <div ui-view=""></div>
      <section class="container-fluid bg-light m-t" ng-controller="dataExtractConfigurationCtrl as dataExtractConfigCtrl">
        <div class="row header">
          <h2>{{ 'ui_dataextract_config_title' | spTranslate }}</h2>
        </div>
        <span ng-if="dataExtractConfigCtrl.errorMessages">
            <div id="alertDiv" class="alert alert-danger" role="alert" tabindex="0">
              <i role="presentation"
                 class="fa fa-exclamation-triangle"></i> {{ dataExtractConfigCtrl.errorMessages | spTranslate }}
            </div>
        </span>
        <form name="dataExtractConfigForm" novalidate="novalidate" autocomplete="false">
          <div id="dataExtractConfigDiv" class="panel">
            <div class="form-group page-settings-container">
              <h4 class="settings-title">{{ 'ui_dataextract_controls' | spTranslate }}</h4>
              <div ng-if="!dataExtractConfigCtrl.dataExtractConfig.messageBusEnabled" class="alert alert-warning">
                <i class="fa fa-exclamation-triangle alert-title" role="presentation"></i>
                <span class="alert-title" role="alert" aria-live="assertive" tabindex="0">
                  <strong>{{'ui_dataextract_messagebus_disabled_globally' | spTranslate }}</strong>
                </span>
              </div>
              <div class="form-group row col-sm-12">
                <div class="form-group row col-sm-12">
                  <sp-checkbox ng-model="dataExtractConfigCtrl.dataExtractConfig.dataExtractTasksEnabled"
                               sp-id="dataExtractTasksEnabled"
                               sp-display-name="{{ 'ui_dataextract_config_enable_label' | spTranslate }}"
                               sp-label="{{ 'ui_dataextract_config_enable_label' | spTranslate }}"
                               sp-disabled="false"
                               class="control-label"/>
                </div>
                <div class="form-group row col-sm-12">
                  <span>
                    <label for="internalProcessingQueue">
                      {{ 'ui_dataextract_config_processing_queue_label' | spTranslate }}
                      <span class="requiredText">*</span>
                      <h:graphicImage id="imgHlpInternalProcessingQueue"
                                      width="12px" height="12px" alt="#{msgs.ui_dataextract_config_processing_queue_help}"
                                      style="cursor:pointer;padding: 0px 7px 0px 7px"
                                      url="/images/icons/dashboard_help_16.png"/>
                    </label>
                    <input type="text" ng-model="dataExtractConfigCtrl.dataExtractConfig.internalProcessingQueue"
                           class="form-control ng-pristine ng-valid ng-scope ng-touched"
                           id="internalProcessingQueue" name="internalProcessingQueue" ng-required="true"
                           ng-disabled="dataExtractConfigCtrl.isCtrlDisabled()"/>
                    <span id="internalProcessingQueue-required-error" tabindex="0" class="text-danger error-outline" aria-live="polite" aria-atomic="true" role="alert"
                          ng-show="!dataExtractConfigForm.internalProcessingQueue.$valid">
                      {{ 'ui_form_required' | spTranslate }}
                    </span>
                  </span>
                </div>
                <div class="form-group row col-sm-12">
                  <span>
                    <label for="messageTimeToLiveInMinutes">
                      {{ 'ui_dataextract_config_time_to_live_label' | spTranslate }}
                      <span class="requiredText">*</span>
                      <h:graphicImage id="imgHlpMessageTimeToLiveInMinutes"
                                      width="12px" height="12px" alt="#{msgs.ui_dataextract_config_time_to_live_help}"
                                      style="cursor:pointer;padding: 0px 7px 0px 7px"
                                      url="/images/icons/dashboard_help_16.png"/>
                    </label>
                    <input type="number" ng-model="dataExtractConfigCtrl.dataExtractConfig.messageTimeToLiveInMinutes"
                           min="0"
                           class="form-control ng-pristine ng-valid ng-scope ng-touched"
                           id="messageTimeToLiveInMinutes" name="messageTimeToLiveInMinutes" ng-required="true"
                           ng-disabled="dataExtractConfigCtrl.isCtrlDisabled()"/>
                    <span id="messageTimeToLiveInMinutes-required-error" tabindex="0" class="text-danger error-outline" aria-live="polite" aria-atomic="true" role="alert"
                          ng-show="!dataExtractConfigForm.messageTimeToLiveInMinutes.$valid">
                      {{ 'ui_form_required' | spTranslate }}
                    </span>
                  </span>
                </div>
              </div>
              <div class="button-group row">
                <div class="col-sm-12">
                  <button type="button"
                          id="cancelBtn"
                          class="btn btn-secondary"
                          ng-click="dataExtractConfigCtrl.cancel()">{{ 'ui_button_return_to_system_setup' | spTranslate }}
                  </button>
                  <button type="submit"
                          id="submitBtn"
                          class="btn btn-primary"
                          aria-label="{{ 'ui_dataextract_config_button_save_aria_label' | spTranslate }}"
                          ng-disabled="dataExtractConfigForm.$invalid || !dataExtractConfigCtrl.hasChanges()"
                          ng-click="dataExtractConfigCtrl.saveConfig()">{{ 'ui_dataextract_config_button_save_label' | spTranslate }}
                  </button>
                </div>
              </div>
            </div>
          </div>
        </form>
      </section>
    </div>
  </ui:define>
</ui:composition>
</body>
</html>